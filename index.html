<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Oso Abrazos - Sprites Funcionando</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Comic Sans MS', cursive;
        }
        #game-container {
            border: 5px solid #34495e;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }
        #debug-info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="debug-info">Cargando...</div>
    <div id="game-container"></div>

    <script>
        console.log("üéÆ Inicializando Oso Abrazos con soluci√≥n SVG...");

        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 500,
            parent: 'game-container',
            backgroundColor: '#87CEEB',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        const game = new Phaser.Game(config);

        function preload() {
            console.log("üì• Cargando recursos...");
            
            // Cargar el SPRITE SHEET que S√ç funciona con animaciones
            this.load.image('sprite_sheet', 'https://raw.githubusercontent.com/Evelez23/-oso.abrazos-/refs/heads/main/img/sprites/Gemini_Generated_Image_clv1shclv1shclv1.png');
            
            // Tambi√©n cargar los SVG como im√°genes est√°ticas (para mostrar que funcionan)
            this.load.image('oso_idle', 'https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_idle.svg');
            this.load.image('oso_walk', 'https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_walk.svg');
            this.load.image('oso_hug', 'https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_hug.svg');
            
            // Plataforma b√°sica
            const graphics = this.make.graphics();
            graphics.fillStyle(0x8D6E63);
            graphics.fillRect(0, 0, 400, 32);
            graphics.generateTexture('platform', 400, 32);
            graphics.destroy();
        }

        function create() {
            console.log("üéÆ Creando escena...");
            
            // Actualizar info de debug
            document.getElementById('debug-info').innerHTML = `
                Sprites cargados: ${this.textures.getTextureKeys().length}<br>
                Usando: Sprite Sheet PNG<br>
                Controles: ‚Üê ‚Üí ‚Üë ESPACIO
            `;
            
            // Fondo
            this.add.rectangle(400, 250, 800, 500, 0x87CEEB);
            
            // Plataformas
            const platforms = this.physics.add.staticGroup();
            platforms.create(400, 470, 'platform').setScale(2).refreshBody();
            platforms.create(200, 350, 'platform');
            platforms.create(600, 350, 'platform');
            platforms.create(100, 250, 'platform');
            platforms.create(700, 200, 'platform');

            // OPCI√ìN 1: Usar el SPRITE SHEET PNG (recomendado para animaciones)
            console.log("üñºÔ∏è Dimensiones del sprite sheet:", this.textures.get('sprite_sheet').getSourceImage().width, "x", this.textures.get('sprite_sheet').getSourceImage().height);
            
            // Crear jugador con sprite sheet
            const player = this.physics.add.sprite(100, 450, 'sprite_sheet');
            player.setBounce(0.3);
            player.setCollideWorldBounds(true);
            player.setScale(0.15); // Ajustar escala seg√∫n el tama√±o del sprite sheet

            // OPCI√ìN 2: Demostrar que los SVG tambi√©n se cargan (pero son est√°ticos)
            const svgDemo = this.add.image(700, 100, 'oso_idle');
            svgDemo.setScale(0.3);
            this.add.text(700, 150, 'SVG Cargado', { 
                fontSize: '12px', 
                fill: '#000',
                fontFamily: 'Comic Sans MS',
                backgroundColor: '#fff',
                padding: { x: 5, y: 2 }
            }).setOrigin(0.5);

            // Sistema de animaci√≥n simple usando el sprite sheet completo
            this.anims.create({
                key: 'idle',
                frames: [{ key: 'sprite_sheet', frame: 0 }],
                frameRate: 10,
                repeat: -1
            });

            // Controles
            this.cursors = this.input.keyboard.createCursorKeys();
            this.spaceKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
            
            // Sistema de puntuaci√≥n
            this.score = 0;
            this.scoreText = this.add.text(16, 16, 'Abrazos: 0', {
                fontSize: '24px',
                fill: '#2C3E50',
                fontFamily: 'Comic Sans MS', 
                backgroundColor: '#FFFFFF',
                padding: { x: 10, y: 5 },
                stroke: '#000',
                strokeThickness: 2
            });

            // Informaci√≥n sobre los sprites
            this.add.text(400, 450, 'Sprite Sheet PNG: ‚úì | SVG: ‚úì', {
                fontSize: '14px',
                fill: '#2C3E50',
                fontFamily: 'Comic Sans MS',
                backgroundColor: '#FFFFFF',
                padding: { x: 10, y: 5 }
            }).setOrigin(0.5);

            this.player = player;
            console.log("‚úÖ Juego listo con ambos tipos de sprites!");
        }

        function update() {
            if (!this.cursors || !this.spaceKey || !this.player) return;

            // Movimiento
            if (this.cursors.left.isDown) {
                this.player.setVelocityX(-200);
                this.player.setFlipX(true);
            } else if (this.cursors.right.isDown) {
                this.player.setVelocityX(200);
                this.player.setFlipX(false);
            } else {
                this.player.setVelocityX(0);
            }

            // Salto
            if (this.cursors.up.isDown && this.player.body.touching.down) {
                this.player.setVelocityY(-350);
            }

            // Abrazo
            if (Phaser.Input.Keyboard.JustDown(this.spaceKey)) {
                this.score += 1;
                this.scoreText.setText('Abrazos: ' + this.score);
                
                // Efecto visual de abrazo
                const hugEffect = this.add.graphics();
                hugEffect.lineStyle(6, 0xFFD700, 0.8);
                hugEffect.strokeCircle(this.player.x, this.player.y, 60);
                
                // Part√≠culas de coraz√≥n
                for (let i = 0; i < 5; i++) {
                    const heart = this.add.text(
                        this.player.x + (Math.random() - 0.5) * 80,
                        this.player.y + (Math.random() - 0.5) * 80,
                        '‚ù§Ô∏è',
                        { fontSize: '24px' }
                    );
                    
                    this.tweens.add({
                        targets: heart,
                        y: heart.y - 100,
                        alpha: 0,
                        duration: 1500,
                        onComplete: () => heart.destroy()
                    });
                }

                this.time.delayedCall(500, () => {
                    hugEffect.destroy();
                });
            }
        }
    </script>
</body>
</html>
