<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Oso Abrazos - Con Sprites Reales</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Comic Sans MS', cursive;
        }
        #game-container {
            border: 5px solid #34495e;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 100;
        }
        #start-button {
            padding: 15px 30px;
            font-size: 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Comic Sans MS';
            margin-top: 20px;
        }
        #loading {
            color: #FFD700;
            font-size: 18px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="start-screen">
        <h1>ü¶• Oso Abrazos</h1>
        <p>¬°Con sprites reales desde GitHub!</p>
        <button id="start-button">Comenzar Juego</button>
        <div id="loading">Cargando sprites...</div>
    </div>
    <div id="game-container"></div>

    <script>
        console.log("üéÆ Inicializando Oso Abrazos con sprites reales...");

        let game;
        let gameStarted = false;

        // URLs de tus sprites reales desde GitHub
        const SPRITES = {
            // Sprites del oso (reemplaza con tus URLs reales)
            oso_idle: "https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_idle.svg",
            oso_walk: "https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_walk.svg", 
            oso_hug: "https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_hug.svg",
            oso_hang: "https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_hang.svg",
            oso_sit: "https://raw.githubusercontent.com/Evelez23/-microdelecion/refs/heads/main/img/oso_sit.svg",
            
            // Sprite sheet que mencionaste
            sprite_sheet: "https://raw.githubusercontent.com/Evelez23/-oso.abrazos-/refs/heads/main/img/sprites/Gemini_Generated_Image_clv1shclv1shclv1.png",
            
            // Sprites de amigos (puedes a√±adir los tuyos)
            amigo_ardilla: "https://example.com/ardilla.svg",
            amigo_conejo: "https://example.com/conejo.svg"
        };

        document.getElementById('start-button').addEventListener('click', startGame);

        function startGame() {
            if (gameStarted) return;
            gameStarted = true;
            
            document.getElementById('loading').textContent = "Cargando sprites desde GitHub...";
            initializeGame();
        }

        function initializeGame() {
            const config = {
                type: Phaser.AUTO,
                width: 800,
                height: 500,
                parent: 'game-container',
                backgroundColor: '#87CEEB',
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: { y: 300 },
                        debug: false
                    }
                },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                }
            };

            game = new Phaser.Game(config);
        }

        function preload() {
            console.log("üì• Cargando sprites reales desde GitHub...");
            
            // Cargar tus sprites reales
            this.load.image('oso_idle', SPRITES.oso_idle);
            this.load.image('oso_walk', SPRITES.oso_walk);
            this.load.image('oso_hug', SPRITES.oso_hug);
            this.load.image('oso_hang', SPRITES.oso_hang);
            this.load.image('oso_sit', SPRITES.oso_sit);
            
            // Intentar cargar el sprite sheet
            this.load.image('sprite_sheet', SPRITES.sprite_sheet);
            
            // Assets de respaldo por si falla la carga
            this.load.image('platform', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==');
            
            // Mostrar progreso de carga
            this.load.on('progress', function (value) {
                document.getElementById('loading').textContent = 
                    `Cargando: ${Math.round(value * 100)}%`;
            });
            
            this.load.on('complete', function () {
                document.getElementById('start-screen').style.display = 'none';
                console.log("‚úÖ Todos los sprites cargados correctamente");
            });
            
            this.load.on('loaderror', function (file) {
                console.warn("‚ùå Error cargando:", file.key);
                document.getElementById('loading').innerHTML += 
                    `<br>Error con: ${file.key}. Usando gr√°ficos de respaldo.`;
            });
        }

        function create() {
            console.log("üéÆ Creando juego con sprites reales...");
            
            // Verificar qu√© sprites se cargaron correctamente
            console.log("Texturas disponibles:", this.textures.getTextureKeys());
            
            // Fondo
            this.add.rectangle(400, 250, 800, 500, 0x87CEEB);
            
            // Plataformas (usar gr√°fico de respaldo si es necesario)
            const platforms = this.physics.add.staticGroup();
            platforms.create(400, 470, 'platform').setScale(2).refreshBody();
            platforms.create(200, 350, 'platform');
            platforms.create(600, 350, 'platform');
            platforms.create(100, 250, 'platform');
            
            // Crear jugador - intentar usar sprites reales
            let player;
            const availableTextures = this.textures.getTextureKeys();
            
            if (availableTextures.includes('oso_idle')) {
                console.log("‚úÖ Usando sprite real del oso");
                player = this.physics.add.sprite(100, 450, 'oso_idle');
            } else if (availableTextures.includes('sprite_sheet')) {
                console.log("‚úÖ Usando sprite sheet");
                player = this.physics.add.sprite(100, 450, 'sprite_sheet');
            } else {
                console.log("‚ö†Ô∏è Usando gr√°fico de respaldo");
                // Crear oso b√°sico program√°ticamente
                const graphics = this.make.graphics();
                graphics.fillStyle(0x8B4513);
                graphics.fillCircle(50, 50, 40);
                graphics.fillStyle(0x000000);
                graphics.fillCircle(35, 35, 5);
                graphics.fillCircle(65, 35, 5);
                graphics.fillCircle(50, 50, 8);
                graphics.generateTexture('bear_fallback', 100, 100);
                graphics.destroy();
                
                player = this.physics.add.sprite(100, 450, 'bear_fallback');
            }
            
            player.setBounce(0.3);
            player.setCollideWorldBounds(true);
            player.setScale(0.8);

            // Sistema de animaciones con sprites reales
            this.anims.create({
                key: 'idle',
                frames: [{ key: 'oso_idle' }],
                frameRate: 10
            });
            
            this.anims.create({
                key: 'walk', 
                frames: [{ key: 'oso_walk' }],
                frameRate: 10
            });
            
            this.anims.create({
                key: 'hug',
                frames: [{ key: 'oso_hug' }],
                frameRate: 10
            });
            
            player.anims.play('idle');

            // Colisiones
            this.physics.add.collider(player, platforms);

            // Controles
            this.cursors = this.input.keyboard.createCursorKeys();
            this.spaceKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);
            
            // Sistema de puntuaci√≥n
            this.score = 0;
            this.scoreText = this.add.text(16, 16, 'Abrazos: 0', {
                fontSize: '24px',
                fill: '#2C3E50',
                fontFamily: 'Comic Sans MS',
                backgroundColor: '#FFFFFF',
                padding: { x: 10, y: 5 }
            });

            // Informaci√≥n de debug
            this.debugText = this.add.text(16, 50, `Sprites cargados: ${availableTextures.length}`, {
                fontSize: '14px',
                fill: '#2C3E50',
                fontFamily: 'Comic Sans MS',
                backgroundColor: '#FFFFFF',
                padding: { x: 5, y: 2 }
            });

            console.log("üéÆ Juego listo con sprites reales!");
        }

        function update() {
            if (!this.cursors || !this.spaceKey) return;
            
            const player = this.children.list.find(child => child.body);
            if (!player) return;

            // Movimiento y animaciones
            if (this.cursors.left.isDown) {
                player.setVelocityX(-200);
                player.setFlipX(true);
                player.anims.play('walk', true);
            } else if (this.cursors.right.isDown) {
                player.setVelocityX(200);
                player.setFlipX(false);
                player.anims.play('walk', true);
            } else {
                player.setVelocityX(0);
                player.anims.play('idle', true);
            }

            // Salto
            if (this.cursors.up.isDown && player.body.touching.down) {
                player.setVelocityY(-350);
            }

            // Abrazo
            if (Phaser.Input.Keyboard.JustDown(this.spaceKey)) {
                player.anims.play('hug', true);
                this.score += 1;
                this.scoreText.setText('Abrazos: ' + this.score);
                
                // Efecto de abrazo
                const hugEffect = this.add.graphics();
                hugEffect.lineStyle(6, 0xFFD700, 0.8);
                hugEffect.strokeCircle(player.x, player.y, 60);
                
                // Volver a idle despu√©s del abrazo
                this.time.delayedCall(500, () => {
                    hugEffect.destroy();
                    player.anims.play('idle', true);
                });
            }
        }
    </script>
</body>
</html>
